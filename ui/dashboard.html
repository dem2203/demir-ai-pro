<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DEMIR AI PRO | Enterprise Trader Dashboard</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    :root {
      --bg-main: #0a0e1a;
      --bg-panel: linear-gradient(145deg, #131925 0%, #0f1621 100%);
      --bg-card: #1a2332;
      --bg-card-hover: #1f2a3d;
      --accent: #00d4ff;
      --accent-glow: rgba(0,212,255,0.25);
      --success: #00ff88;
      --danger: #ff3366;
      --gold: #ffd700;
      --text-main: #f0f4f8;
      --text-secondary: #8b95a8;
      --border: rgba(255,255,255,0.06);
      --border-bright: rgba(0,212,255,0.3);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--bg-main);
      color: var(--text-main);
      line-height: 1.6;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 24px 36px;
      background: var(--bg-panel);
      border-radius: 16px;
      border: 1px solid var(--border-bright);
      margin-bottom: 32px;
      box-shadow: 0 20px 60px -15px rgba(0,0,0,0.8);
    }
    .logo { 
      font-size: 2.2rem; 
      font-weight: 800; 
      background: linear-gradient(135deg, var(--accent) 0%, #b24bf3 100%); 
      -webkit-background-clip: text; 
      -webkit-text-fill-color: transparent;
    }
    .health-badge {
      display: flex; 
      align-items: center; 
      gap: 10px;
      background: rgba(0,255,136,0.1);
      padding: 10px 22px;
      border-radius: 30px;
      font-weight: 600;
      border: 1px solid rgba(0,255,136,0.3);
      color: var(--success);
    }
    .dot {
      width: 12px; 
      height: 12px;
      border-radius: 50%;
      background: var(--success);
      box-shadow: 0 0 12px var(--success);
      animation: pulse-dot 2s infinite;
    }
    @keyframes pulse-dot {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    .panel {
      background: var(--bg-panel);
      border-radius: 16px;
      padding: 28px 32px;
      margin-bottom: 28px;
      border: 1px solid var(--border);
      box-shadow: 0 20px 60px -15px rgba(0,0,0,0.8);
    }
    h2 { 
      font-size: 1.5rem; 
      margin-bottom: 20px; 
      color: var(--accent); 
      font-weight: 700;
    }
    .price-item {
      display: flex;
      justify-content: space-between;
      padding: 18px 24px;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border);
      font-size: 1.3rem;
      font-weight: 600;
    }
    .price-up { color: var(--success); background: rgba(0,255,136,0.05); }
    .price-down { color: var(--danger); background: rgba(255,51,102,0.05); }
    .signal-table {
      width: 100%;
      border-collapse: collapse;
    }
    .signal-table th, .signal-table td {
      padding: 14px 12px;
      border-bottom: 1px solid var(--border);
      text-align: left;
    }
    .signal-table th { 
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
      font-size: 12px;
    }
    .s-long { color: var(--success); font-weight: 700; }
    .s-short { color: var(--danger); font-weight: 700; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">âš¡ DEMIR AI PRO v8.0</div>
      <div class="health-badge"><span class="dot"></span>Aktif</div>
    </div>

    <div class="panel">
      <h2>ðŸ’° CanlÄ± Fiyatlar</h2>
      <div id="prices">YÃ¼kleniy or...</div>
    </div>

    <div class="panel">
      <h2>ðŸŸ¢ AI Sinyalleri</h2>
      <table class="signal-table" id="signal-table">
        <thead>
          <tr>
            <th>Coin</th>
            <th>YÃ¶n</th>
            <th>GiriÅŸ</th>
            <th>TP1</th>
            <th>TP2</th>
            <th>SL</th>
            <th>GÃ¼ven</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    const API_BASE = window.location.origin;

    async function updatePrices() {
      try {
        const resp = await fetch(`${API_BASE}/api/prices`);
        const data = await resp.json();
        const pricesDiv = document.getElementById('prices');
        pricesDiv.innerHTML = '';
        
        for (const [symbol, v] of Object.entries(data.prices || {})) {
          let cls = v.change24h > 0 ? 'price-up' : (v.change24h < 0 ? 'price-down' : '');
          pricesDiv.innerHTML += `<div class="price-item ${cls}"><b>${symbol.replace('USDT','')}</b> <span>$${v.price?.toLocaleString() || '-'}</span></div>`;
        }
      } catch(e) {
        document.getElementById('prices').innerHTML = 'Fiyatlar alÄ±namadÄ±';
      }
    }

    async function updateSignals() {
      try {
        const resp = await fetch(`${API_BASE}/api/signals/latest?limit=8`);
        const data = await resp.json();
        const tbody = document.querySelector('#signal-table tbody');
        tbody.innerHTML = '';
        
        if (data.signals && Object.keys(data.signals).length > 0) {
          for (const [symb, arr] of Object.entries(data.signals)) {
            for (const s of arr) {
              tbody.innerHTML += `<tr>
                <td>${s.symbol||'-'}</td>
                <td class="s-${s.direction?.toLowerCase()||'neutral'}">${s.direction||'-'}</td>
                <td>${s.entry||'-'}</td>
                <td>${s.tp1||'-'}</td>
                <td>${s.tp2||'-'}</td>
                <td>${s.sl||'-'}</td>
                <td>${(s.confidence||0) + '%'}</td>
              </tr>`;
            }
          }
        } else {
          tbody.innerHTML = '<tr><td colspan="7">Aktif sinyal yok</td></tr>';
        }
      } catch(e) {
        document.querySelector('#signal-table tbody').innerHTML = '<tr><td colspan="7">Sinyal alÄ±namadÄ±</td></tr>';
      }
    }

    function updateAll() {
      updatePrices();
      updateSignals();
    }

    updateAll();
    setInterval(updateAll, 6000);
  </script>
</body>
</html>
